## Funtion that computes sum/averages of a given number of columns
## Input (matrix,operation)
## matrix <- a matrix of obs or ens
## operation -> [1,2] for [average,sum]

upscale <- function(matrix,operation){
  if (operation == 1){ # For Temperature
    a0 <- rowMeans(matrix[,1:7],na.rm = TRUE) 
    a1 <- rowMeans(matrix[,8:14],na.rm = TRUE)
    a2 <- rowMeans(matrix[,15:21],na.rm = TRUE)
    a3 <- rowMeans(matrix[,22:28],na.rm = TRUE)
    a4 <- rowMeans(matrix[,29:35],na.rm = TRUE) 
    a5 <- rowMeans(matrix[,36:42],na.rm = TRUE)
    a6 <- rowMeans(matrix[,43:49],na.rm = TRUE) 
    a7 <- rowMeans(matrix[,50:56],na.rm = TRUE) 
    a8 <- rowMeans(matrix[,57:63],na.rm = TRUE) 
    a9 <- rowMeans(matrix[,64:70],na.rm = TRUE) 
    a10 <-rowMeans(matrix[,71:77],na.rm = TRUE) 
    a11 <- rowMeans(matrix[,78:84],na.rm = TRUE)
    a12 <-rowMeans(matrix[,85:91],na.rm = TRUE) 
    a13 <- rowMeans(matrix[,92:98],na.rm = TRUE) 
    a14 <- rowMeans(matrix[,99:105],na.rm = TRUE)
    a15 <-rowMeans(matrix[,106:112],na.rm = TRUE) 
    a16 <-rowMeans(matrix[,113:119],na.rm = TRUE) 
    a17 <-rowMeans(matrix[,120:126],na.rm = TRUE)
    a18 <-rowMeans(matrix[,127:133],na.rm = TRUE) 
    a19 <-rowMeans(matrix[,134:140],na.rm = TRUE) 
    a20 <- rowMeans(matrix[,141:147],na.rm = TRUE) 
    a21 <-rowMeans(matrix[,148:154],na.rm = TRUE) 
    a22 <- rowMeans(matrix[,155:161],na.rm = TRUE)
    a23 <- rowMeans(matrix[,162:168],na.rm = TRUE) 
    a24 <-rowMeans(matrix[,169:175],na.rm = TRUE) 
    a25 <-rowMeans(matrix[,176:182],na.rm = TRUE) 
    a26 <-rowMeans(matrix[,183:189],na.rm = TRUE) 
    a27 <-rowMeans(matrix[,190:196],na.rm = TRUE) 
    a28 <- rowMeans(matrix[,197:203],na.rm = TRUE) 
    a29 <-rowMeans(matrix[,204:210],na.rm = TRUE)
    b0 <- cbind(a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14)
    b1 <- cbind(a15,a16,a17,a18,a19,a20,a21,a22,a23,a24,a25,a26,a27,a28,a29)
    matrix_out <- cbind(b0,b1)
    return(matrix_out)
    
  } else {  # For precipitation and et0
    a0 <- rowSums(matrix[,1:7],na.rm = TRUE) 
    a1 <- rowSums(matrix[,8:14],na.rm = TRUE)
    a2 <- rowSums(matrix[,15:21],na.rm = TRUE)
    a3 <- rowSums(matrix[,22:28],na.rm = TRUE)
    a4 <- rowSums(matrix[,29:35],na.rm = TRUE) 
    a5 <- rowSums(matrix[,36:42],na.rm = TRUE)
    a6 <- rowSums(matrix[,43:49],na.rm = TRUE) 
    a7 <- rowSums(matrix[,50:56],na.rm = TRUE) 
    a8 <- rowSums(matrix[,57:63],na.rm = TRUE) 
    a9 <- rowSums(matrix[,64:70],na.rm = TRUE) 
    a10 <-rowSums(matrix[,71:77],na.rm = TRUE) 
    a11 <- rowSums(matrix[,78:84],na.rm = TRUE)
    a12 <-rowSums(matrix[,85:91],na.rm = TRUE) 
    a13 <- rowSums(matrix[,92:98],na.rm = TRUE) 
    a14 <- rowSums(matrix[,99:105],na.rm = TRUE)
    a15 <-rowSums(matrix[,106:112],na.rm = TRUE) 
    a16 <-rowSums(matrix[,113:119],na.rm = TRUE) 
    a17 <-rowSums(matrix[,120:126],na.rm = TRUE)
    a18 <-rowSums(matrix[,127:133],na.rm = TRUE) 
    a19 <-rowSums(matrix[,134:140],na.rm = TRUE) 
    a20 <- rowSums(matrix[,141:147],na.rm = TRUE) 
    a21 <-rowSums(matrix[,148:154],na.rm = TRUE) 
    a22 <- rowSums(matrix[,155:161],na.rm = TRUE)
    a23 <- rowSums(matrix[,162:168],na.rm = TRUE) 
    a24 <-rowSums(matrix[,169:175],na.rm = TRUE) 
    a25 <-rowSums(matrix[,176:182],na.rm = TRUE) 
    a26 <-rowSums(matrix[,183:189],na.rm = TRUE) 
    a27 <-rowSums(matrix[,190:196],na.rm = TRUE) 
    a28 <- rowSums(matrix[,197:203],na.rm = TRUE) 
    a29 <-rowSums(matrix[,204:210],na.rm = TRUE)
    b0 <- cbind(a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14)
    b1 <- cbind(a15,a16,a17,a18,a19,a20,a21,a22,a23,a24,a25,a26,a27,a28,a29)
    matrix_out <- cbind(b0,b1)
    return(matrix_out)
    
  } ## End of if condition
  
} # End of function